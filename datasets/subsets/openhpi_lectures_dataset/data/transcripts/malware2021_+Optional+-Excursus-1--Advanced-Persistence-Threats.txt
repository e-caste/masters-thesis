WEBVTT

1
00:00:00.220 --> 00:00:04.650 
Dear learners. Welcome back to our
openHPI course "Cyberthreats: Malware".

2
00:00:04.990 --> 00:00:10.290 
Today we're going to have a deeper look into
the group of Advanced Persistence Threats.

3
00:00:10.510 --> 00:00:16.090 
What are advanced persistence threats?
So one famous example of an APT

4
00:00:16.810 --> 00:00:20.100 
was the hack of the German
Bundestag in 2015.

5
00:00:20.310 --> 00:00:23.620 
There were big news messages
everywhere that the computer systems

6
00:00:23.620 --> 00:00:27.270 
of the Bundestag had to go offline
for several days. The reason

7
00:00:27.270 --> 00:00:31.940 
behind this was that there was a cyber-attack
against the IT systems of the Bundestag.

8
00:00:32.590 --> 00:00:36.860 
After all that we know, it started
by social engineering email

9
00:00:36.860 --> 00:00:40.590 
to one of the representatives. So
we earlier talked about social

10
00:00:40.590 --> 00:00:45.130 
engineering attacks already and how
they are a threat to everyone and this

11
00:00:45.440 --> 00:00:49.020 
again undermines that it is
important to be on the look-out

12
00:00:49.020 --> 00:00:52.510 
for social engineering
attacks. So initial access

13
00:00:53.050 --> 00:00:56.930 
was gained by compromised passwords
because one of the representatives

14
00:00:56.930 --> 00:01:01.190 
used their password because they reacted
on such a social engineering email.

15
00:01:01.660 --> 00:01:06.570 
And then there was a further spread
of the malware or of the attackers

16
00:01:06.790 --> 00:01:10.120 
through the use of self developed
Command &amp; Control service

17
00:01:10.870 --> 00:01:15.020 
to control and to guide the
malware to the different IT systems

18
00:01:16.040 --> 00:01:20.050 
and they spread to many
different computers and

19
00:01:20.050 --> 00:01:24.580 
the final goal was to retrieve
all new documents. As we know

20
00:01:24.580 --> 00:01:28.190 
this happened in 2015
and we have a short snippet of

21
00:01:28.430 --> 00:01:32.740 
part of the source code of the malware
here. And what it did was basically

22
00:01:32.980 --> 00:01:38.250 
grab all the different document
types, so pdf, xls documents

23
00:01:38.740 --> 00:01:44.010 
and those documents that are
created after the first of May

24
00:01:44.010 --> 00:01:45.410 
in 2015

25
00:01:46.510 --> 00:01:50.220 
and copy them basically somewhere else
and send them back to the attackers.

26
00:01:50.530 --> 00:01:53.300 
So the attackers infiltrated the
Bundestag and wanted to have

27
00:01:53.300 --> 00:01:57.210 
all new documents that were
created after may 2015

28
00:01:57.210 --> 00:01:58.680 
or in May 2015.

29
00:01:59.840 --> 00:02:06.210 
So this is only one example of a
famous APT attack. So what are APTs

30
00:02:06.210 --> 00:02:10.540 
in general? Let's look into it. APTs,
Advanced Persistence Threats,

31
00:02:10.540 --> 00:02:13.730 
are highly dangerous and highly
specialised types of attacks.

32
00:02:14.680 --> 00:02:19.150 
They usually used to target
highly sensible targets, so such

33
00:02:19.150 --> 00:02:23.710 
as, for example the government or military
or big partners of the industry,

34
00:02:24.210 --> 00:02:28.580 
and the motivation behind this
is either maybe I want to have a

35
00:02:28.590 --> 00:02:30.990 
widespread information
retrieval, I want

36
00:02:31.470 --> 00:02:35.800 
basically to eavesdrop on a very big
company in a very big large scale

37
00:02:36.010 --> 00:02:40.110 
or I might have the intention
to or an attacker might have the

38
00:02:40.980 --> 00:02:45.420 
intention to deactivate or
destruct critical infrastructure

39
00:02:45.770 --> 00:02:49.960 
or there might even be political goals
connected to it. So, for example, if

40
00:02:50.290 --> 00:02:54.320 
we saw that building has a cyber
attack or we saw that institution

41
00:02:54.320 --> 00:02:56.370 
has a cyber attack,
then political

42
00:02:57.560 --> 00:03:01.560 
forces of one side or the other
are strengthened. So there's

43
00:03:01.640 --> 00:03:04.880 
various different motivation for
advanced persistent threats.

44
00:03:05.030 --> 00:03:08.830 
But what is so special about
it and what differentiates an

45
00:03:09.290 --> 00:03:11.900 
APT from a standard malware
attack for example?

46
00:03:12.920 --> 00:03:17.190 
So in general it is the three
words that it consists of. So

47
00:03:17.190 --> 00:03:22.040 
we have the Advanced, which means it is
usually highly developed, unobtrusive,

48
00:03:22.310 --> 00:03:25.910 
so you don't see
what happens, it tries to

49
00:03:25.910 --> 00:03:29.770 
stay under the radar. The attack
itself has very secret attack

50
00:03:29.770 --> 00:03:34.030 
methods. So the idea here is not
that we launch a malware which

51
00:03:34.030 --> 00:03:37.740 
gets access to a system, and for
example, similar to a ransomware

52
00:03:37.740 --> 00:03:39.820 
which we would talk
about the next week.

53
00:03:40.690 --> 00:03:44.140 
Ransomware would lock the system
and look for immediate profit

54
00:03:44.180 --> 00:03:49.670 
because it asks you to provide ransom to
pay some money to unlock your device

55
00:03:49.890 --> 00:03:53.520 
but an advanced persistent threat,
they would usually try to

56
00:03:53.520 --> 00:03:58.530 
be very secret or very unobtrusive so
that they don't get caught easily.

57
00:03:59.460 --> 00:04:03.690 
Further they often in particular start
by using social engineering methods

58
00:04:03.870 --> 00:04:07.340 
because after all social engineering
is still, in particular,

59
00:04:07.340 --> 00:04:10.760 
in modern times, one of the key factor,
one of the key breaking points

60
00:04:11.230 --> 00:04:14.510 
into current
technology companies.

61
00:04:15.150 --> 00:04:22.320 
And they further use also on the one hand
known and also currently unknown weaknesses.

62
00:04:22.460 --> 00:04:26.590 
So currently unknown vulnerabilities,
the so called zero-day exploits

63
00:04:26.870 --> 00:04:31.380 
are in particular vulnerabilities
which have not yet been published.

64
00:04:31.390 --> 00:04:35.100 
So they are not officially known
and therefore the vendors

65
00:04:35.100 --> 00:04:38.630 
potentially didn't have the
opportunity yet to provide patches

66
00:04:38.630 --> 00:04:43.300 
or fixes for those vulnerabilities
and therefore the software

67
00:04:43.300 --> 00:04:46.440 
to abuse those vulnerabilities
is called zero-day exploits

68
00:04:46.590 --> 00:04:50.890 
because it happens on the zero day
because they are not known yet.

69
00:04:51.740 --> 00:04:55.950 
Further the advanced persistence
threats often happen in multiple

70
00:04:55.950 --> 00:04:59.900 
steps. So often it's not just
one malware which attacks, but

71
00:04:59.900 --> 00:05:03.670 
then there's more to the steps connected
to it. Multiple different malware change,

72
00:05:04.240 --> 00:05:08.830 
multiple types of interaction with
potential IT systems change.

73
00:05:09.780 --> 00:05:14.410 
And then we have the next word
the Persistent. So as we know

74
00:05:14.900 --> 00:05:19.320 
the Bundestag for example
spent a couple months but

75
00:05:19.370 --> 00:05:22.980 
the advanced persistence threats
in general can even spend

76
00:05:22.980 --> 00:05:27.660 
about multiple years without
being seen. As I said earlier

77
00:05:27.840 --> 00:05:32.080 
the idea is that it's very unobtrusive,
very secret. So the idea is to stay

78
00:05:32.420 --> 00:05:35.680 
undiscovered for as long as
possible or at least until the

79
00:05:35.680 --> 00:05:36.960 
goal has been reached.

80
00:05:38.250 --> 00:05:42.960 
Then finally the attackers often
have a very specific goal.

81
00:05:42.960 --> 00:05:45.740 
So the idea is not just
to get some money or

82
00:05:46.330 --> 00:05:51.010 
maybe get some influence on some
system, but oftentimes the idea is

83
00:05:51.450 --> 00:05:55.350 
to get a very detailed document
which is maybe hidden behind

84
00:05:55.370 --> 00:05:58.810 
multiple layers of different computers
that we need to move through.

85
00:06:00.580 --> 00:06:06.100 
And finally we have the threat
and the threat means that our

86
00:06:06.680 --> 00:06:10.500 
attackers are often very organized
teams. So often it's not

87
00:06:10.500 --> 00:06:13.860 
one person alone that does an
advance persistent threat

88
00:06:15.210 --> 00:06:20.490 
and therefore often the attackers own
basically unlimited resources because

89
00:06:20.980 --> 00:06:26.020 
most times the attacks are also
observed and controlled by experts.

90
00:06:26.370 --> 00:06:31.040 
So human experts that sit in the background
of the attack and steer the malware,

91
00:06:31.300 --> 00:06:34.750 
react on whatever they see what
happens or whatever they see

92
00:06:34.750 --> 00:06:38.940 
what might be in the way. Again
it's not just one simple malware

93
00:06:38.940 --> 00:06:42.510 
attachment which gets sent by email
and then it's done and completed,

94
00:06:42.680 --> 00:06:46.950 
but it's then the multitude of
steps that needs to happen for

95
00:06:46.950 --> 00:06:50.060 
the attackers to be able to
achieve their final target.

96
00:06:51.250 --> 00:06:56.040 
And an APT attack is classified by
different phases or can be recognized

97
00:06:56.040 --> 00:06:59.670 
or broken down into different
phases. So at first we have the

98
00:06:59.670 --> 00:07:03.690 
phase of the reconnaissance where
the attackers basically try

99
00:07:03.690 --> 00:07:05.870 
to gather
information, they

100
00:07:06.880 --> 00:07:10.780 
try to go through all the social media
information, to other information

101
00:07:11.280 --> 00:07:14.750 
available on the internet and
just gather as many information

102
00:07:14.750 --> 00:07:16.780 
as possible on
their target.

103
00:07:17.900 --> 00:07:20.430 
And then it comes the
phase of the first access.

104
00:07:20.980 --> 00:07:25.340 
And as I said earlier, they try
to remain undiscovered. So the

105
00:07:25.340 --> 00:07:28.290 
first access tries to be without
attracting attention.

106
00:07:28.700 --> 00:07:33.530 
And oftentimes one good chance for
such a thing is social engineering

107
00:07:33.540 --> 00:07:35.080 
because it still
works today.

108
00:07:36.640 --> 00:07:39.860 
The next phase is then once we have
received access we need to

109
00:07:39.860 --> 00:07:41.540 
secure that access. So the attacker

110
00:07:42.250 --> 00:07:46.270 
will try to install remote access
tools, they will use for example

111
00:07:46.270 --> 00:07:49.810 
command control service
for the malware to

112
00:07:49.810 --> 00:07:53.210 
be able to communicate back to
the command and control server

113
00:07:53.450 --> 00:07:57.530 
and then to be able to retrieve
new instructions. So for example,

114
00:07:57.780 --> 00:08:01.090 
now that we have secured our
access on this computer, what do

115
00:08:01.090 --> 00:08:05.280 
we do? Do we actually find our goal,
maybe our piece of information

116
00:08:05.280 --> 00:08:08.570 
that we were looking for? Do we
find that on our computer or

117
00:08:08.570 --> 00:08:12.300 
do we need to spread further? And
that spreading further phase

118
00:08:12.490 --> 00:08:14.390 
is called the lateral
movement phase.

119
00:08:15.390 --> 00:08:19.480 
In the lateral movement phase we were
basically inside the network,

120
00:08:19.480 --> 00:08:23.180 
inside the IT system, then try
to do further reconnaissance,

121
00:08:23.180 --> 00:08:28.390 
try to get information on further potential
targets, try to get information on

122
00:08:28.590 --> 00:08:33.160 
where we would be interested as
attackers to go to next, to

123
00:08:33.160 --> 00:08:36.740 
reach our final goal. And then
the idea is that the malware

124
00:08:36.740 --> 00:08:40.440 
or the infection of the attackers
just spreads to the next

125
00:08:40.440 --> 00:08:44.580 
computers or the human expert
behind the attack then launches

126
00:08:44.590 --> 00:08:49.680 
next kinds of malware, next steps to be
able to infiltrate the next computer.

127
00:08:50.610 --> 00:08:54.290 
Obviously on the next computers we
have to secure our access again.

128
00:08:54.420 --> 00:08:59.370 
So from lateral movement to secure
access, this is some kind of a circle.

129
00:08:59.700 --> 00:09:03.600 
Each new device that we will gain
access to, we want to secure

130
00:09:03.600 --> 00:09:06.720 
our access, we don't want
to get thrown off easily.

131
00:09:07.780 --> 00:09:11.300 
And then finally we want to
achieve our target somewhere. So

132
00:09:11.610 --> 00:09:16.830 
in most cases we want to be able to pursue
some data exfiltration, to steal some

133
00:09:16.980 --> 00:09:21.550 
secret documents or be able to
sabotage something, whatever

134
00:09:21.780 --> 00:09:23.510 
we were interested in
in the beginning.

135
00:09:24.430 --> 00:09:29.820 
One other prominent example that we've
seen already about ten years ago

136
00:09:30.040 --> 00:09:33.950 
is called Stuxnet. Stuxnet is a
malware which has been detected

137
00:09:33.950 --> 00:09:35.480 
on the computer system

138
00:09:36.160 --> 00:09:39.500 
of Iranian uran enrichment plants

139
00:09:40.750 --> 00:09:42.210 
already back in 2010.

140
00:09:42.990 --> 00:09:47.210 
So Stuxnet has abused
various, formerly unknown,

141
00:09:47.720 --> 00:09:51.790 
zero-day vulnerabilities,
and for example

142
00:09:52.560 --> 00:09:55.910 
taken a loan for security
vulnerabilities found in Windows

143
00:09:56.050 --> 00:10:01.350 
and then various vulnerabilities in the
control software for uranium centrifuges.

144
00:10:01.460 --> 00:10:06.750 
So the SCADA software, which means that this
is not just a malware which jumps into

145
00:10:06.950 --> 00:10:10.530 
any one vulnerability and tries
to cause damage there, but the

146
00:10:10.530 --> 00:10:15.360 
idea is really we chain together
multiple complicated vulnerabilities

147
00:10:15.360 --> 00:10:20.140 
to be able to achieve the final
target. We will have humans

148
00:10:20.140 --> 00:10:24.560 
in the back, experts in the back which
control the flow of the infection

149
00:10:24.880 --> 00:10:26.130 
and which are able to

150
00:10:26.810 --> 00:10:30.630 
maybe even make use of new
vulnerabilities that come up in

151
00:10:30.630 --> 00:10:37.650 
the cause of the infection and really create a
sophisticated malware, sophisticated infection.

152
00:10:38.940 --> 00:10:43.010 
And such attacks on the
control software of

153
00:10:43.540 --> 00:10:48.020 
industry plants, they have been
fiction before. So they have

154
00:10:48.020 --> 00:10:52.720 
been mentioned in research papers
but previously everybody

155
00:10:52.720 --> 00:10:55.990 
thought that would rather be
fiction because those control

156
00:10:55.990 --> 00:10:59.440 
systems usually they were not
connected to the internet, there

157
00:10:59.440 --> 00:11:03.700 
were so called air gaps. But
the question is how do we get

158
00:11:03.700 --> 00:11:06.470 
to a system that is not
connected to the internet?

159
00:11:07.340 --> 00:11:11.190 
Yeah apparently as usual we can
use social engineering. So in

160
00:11:11.190 --> 00:11:15.860 
the case of Stuxnet the initial access
happened through social engineering and

161
00:11:16.020 --> 00:11:20.170 
basically through a USB stick
where they put the malware on hid it

162
00:11:20.430 --> 00:11:24.670 
and that USB-stick was then after
all given to an employee and

163
00:11:24.670 --> 00:11:28.260 
he used it in the factory to maybe
copy some documents or to

164
00:11:28.260 --> 00:11:33.780 
maybe bring a patch to the system and
thereby he infected the factory itself.

165
00:11:35.560 --> 00:11:39.550 
The expected goal of the attack
in that case was the sabotage

166
00:11:39.550 --> 00:11:41.450 
of the Iranian
Nuclear program.

167
00:11:42.220 --> 00:11:47.500 
We attacked the plants for the
uranium enrich or they attacked

168
00:11:47.500 --> 00:11:50.310 
the plants for the
uranium enrichment. So

169
00:11:50.850 --> 00:11:54.210 
one expects that the goal of the
attack was the sabotage of

170
00:11:54.220 --> 00:11:56.480 
the nuclear program
of the Iran.

171
00:11:57.190 --> 00:12:02.520 
And first variations of the
Stuxnet worm were already

172
00:12:02.520 --> 00:12:05.900 
seen in 2009 but at
that point it was not

173
00:12:05.900 --> 00:12:09.110 
referred to as Stuxnet yet. That
only happened after the attack

174
00:12:09.320 --> 00:12:14.160 
and then until July 2010
when it was actually discovered,

175
00:12:14.680 --> 00:12:19.290 
there were no other big discoveries
of the Stuxnet. So this is really

176
00:12:19.290 --> 00:12:24.380 
a malware which has been created just
to attack that particular system.

177
00:12:24.620 --> 00:12:27.280 
So again it's not
a malware which, or APTs

178
00:12:28.560 --> 00:12:31.460 
are usually not kinds of malware
which get sent out to hundred

179
00:12:31.460 --> 00:12:34.100 
thousands of devices,
but which are very

180
00:12:35.160 --> 00:12:39.170 
precisely crafted to that system
that they are supposed to attack.

181
00:12:40.430 --> 00:12:44.370 
And we also know that the attack is,
because of all the preparations,

182
00:12:44.370 --> 00:12:46.680 
need to have had massive
amounts of resources.

183
00:12:47.090 --> 00:12:50.650 
And very early guess was that the
attackers are probably with

184
00:12:50.650 --> 00:12:55.850 
access to infrastructures of maybe a
state or a country and then according

185
00:12:56.070 --> 00:13:00.490 
to the insights from the
whistleblower Edward Snowden, the USA

186
00:13:00.980 --> 00:13:05.760 
and Israel might be the creators
of Stuxnet. So Edward Snowden

187
00:13:05.760 --> 00:13:10.610 
said okay it was the USA and Israel.
So if one wants to believe

188
00:13:10.620 --> 00:13:14.540 
him and the documents he shared
then they might be the creators

189
00:13:14.550 --> 00:13:20.140 
of Stuxnet and the actual goal was the
sabotage of the Iranian nuclear program.

190
00:13:21.020 --> 00:13:26.340 
That brings us to the end of our excursus on
the topic of advanced persistence threats.

191
00:13:26.580 --> 00:13:30.970 
We learned that advanced persistence
threats are really highly specialised

192
00:13:31.270 --> 00:13:36.030 
kinds of malware, highly specialized
attacks that only target very specific

193
00:13:36.830 --> 00:13:42.120 
enterprises, very specific
companies, industries, even states

194
00:13:42.120 --> 00:13:46.990 
or countries could be targeted
and it is basically chaining

195
00:13:46.990 --> 00:13:51.500 
and linking together all the other different
information and ideas of malware

196
00:13:52.040 --> 00:13:56.330 
and of threats we have to create
something very sophisticated that

197
00:13:56.610 --> 00:13:58.680 
can basically not
be detected.

198
00:13:59.440 --> 00:14:03.490 
I thank you for your attention and I
hope you enjoy the rest of your day.
